recovery:
  tools:
    - 'photorec'
    - 'scalpel'
    - 'foremost'
    - 'binwalk'
    - 'ntfsundelete'
    - 'dd/xxd/grep'
    - 'sleuthkit'
  
  behaviors:
    - fs: 'ext2'
      behavior: 'inode marked as unallocated, data block pointers still present)'
    - fs: 'ext3'
      behavior: 'inode marked as unallocated, data block pointers zeroed'
    - fs: 'ext4'
      behavior: 'inode marked as unallocated, extents zeroed'
    - fs: 'ntfs'
      behavior: 'clusters marked as unallocated, data runs not cleared'
    - fs: 'fat*'
      behavior: 'clusters marked as unallocated, size and filename kept in cluster, chain of cluster lost'
    - fs: 'exfat'
      behavior: 'clusters marked as unallocated, size and filename kept in cluster, chain of cluster lost'


  cheat_sheet:
    - description: 'scan recoverable files with ntfsundelete (100%, filename pattern, since time)'
      command: 'ntfsundelete /dev/loopX -s -p 100 -m "<pattern.ext>" -t 1m' 
    - description: 'recover a file with ntfsundelete'
      command: 'ntfsundelete /dev/loopX -i <inode> -d recovered/'
    - description: 'carve with software based on magic numbers'
      command: 'photorec / scalpel / foremost'
    - description: 'carve binary files (eg. firmware, archive) with binwalk'
      command: 'binwalk -o <numeric offset> -e disk.raw'
    - description: 'identify offset start/end of a file manually'
      command: 'xxd -s <numeric start offset> disk.raw | grep <hexa magic number>'
    - description: 'carve file with dd'
      command: 'dd if=disk.raw of=carved.dat bs=1 skip=<numeric start offset> count=<byte size>'
    - description: 'identify offset X in a file containing a keyword'
      command: 'grep -abi <regex/keyword> disk .raw'
    - description: 'identify partition start Y containing offset X (search X/sector size)'
      command: 'mmls disk.raw'
    - description: 'identify data block containing offset X (search (X-Y*sector size)/block size)'
      command: 'fsstat -o <partition sector offset> disk.raw'
    - description: 'from allocated data block, retrieve associated inode'
      command: 'ifind -o <partition sector offset> -d <data block number> disk.raw'
    - description: 'carve file from inode (data blocks allocated)'
      command: 'icat -o <partition sector offset> disk.raw <inode> > carved.dat'
    - description: 'carve data from unallocated data block'
      command: 'blkcat -o <partition sector offset> disk.raw <data block> > carved.dat'
    - description: 'list data block attached to an inode'
      command: 'istat -o <partition sector offset> disk.raw <inode>'
    - description: 'dump all unallocated data block in a partition'
      command: 'blkls -o <partition sector offset> disk.raw > unallocated.dat'

timelines:
  tools:
    - 'sleuthkit'
    - 'log2timeline'
  cheat_sheet:
    - description: 'Create timeline of files/folders and deleted ones on linux'
      command: "fls -{F,D}rp{u,d} -m '/'  disk.raw | tee fls_{files,folders}_{allocated,deleted}.body"
    - description: 'Create timeline of files/folders and deleted ones on windows'
      command: 'WIP'
    - description: 'Create timeline of events on a host with plaso'
      command: 'WIP'

windows:
  tools:
    - 'libvshadow'
    - 'sleuthkit'
    - 'plaso'
    - 'https://github.com/poorbillionaire/usn-journal-parser'

  cheat_sheet:
    - description: 'identify VSC (Volume Shadow Copy)'
      command: 'vshadowinfo -o <partition offset> disk.raw'
    - description: 'mount VSC device'
      command: 'vshadowmount -o <partition offset> disk.raw /tmp/fuse'
    - description: 'mount VSC'
      command: 'mount -o ro,loop,show_sys_files,streams_interface=windows /tmp/fuse/vssX <mount_point>'
    - description: 'extract $Extend\$UsnJournal:$J with plaso'
      command: 'WIP'
    - description: 'extract $Extend\$UsnJournal:$J (determine inode from fls output)'
      command: 'icat -h -o <partition sector offset> disk.raw <inode> > usnjrnl.dat'
    - description: 'parse $Extend\$UsnJournal:$J'
      command: 'python3 usn.py -c -f usnjrnl.dat -o usnjrnl.csv'
  
general:
  tools:
    - 'find'
    - 'sha256sum'
  cheat_sheet:
    - description: 'compute digest of all files'
      command: 'find . -type f -exec sha256sum {} \; > ../sha256_all_files.txt'
    - description: 'compare integrity of all files with a witness file'
      command: 'sha256sum -c sha256_all_files.txt'