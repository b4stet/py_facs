chain_of_custody:
  - 'take photos (serial number, vendor, model, ...)'
  - 'collect disk info (serial number, vendor, model, file system, partition table)'
  - 'save version of tools used'
  - 'check dump integrity'
  - 'save log files if any generated by the imaging tool'
  - 'create a working copy of the dump'

physical_layer:
  glossary:
    - name: 'device'
      examples: 
        - '/dev/sdX'
        - '/dev/nvmeXn'
    - name: 'block device'
      examples:
        - '/dev/sdXY'
        - '/dev/nvmeXnYpZ'
  tools:
    - 'lsblk/lsblkid'
    - 'lshw'
    - 'lsscsi'
    - 'nvme'
    - 'hdparm'
    - 'fdisk'
    - 'file'
  cheat_sheet:
    - description: 'list block devices, with size, mountpoint, model, label and file system'
      command: 'lsblk -o NAME,FSTYPE,LABEL,MOUNTPOINT,SIZE,MODEL'
    - description: 'list mountpoints and volume UUIDs'
      command: 'lsblkid'
    - description: 'list devices, with size, vendor, product and serial number'
      command: 'lshw -c storage -c disk'
    - description: 'info about SCSI devices (model, firmware revision, device, size)'
      command: 'lsscsi -s'
    - description: 'info about a SATA device (model, serial number, firmware revision)'
      command: 'hdparm -I /dev/<device>'
    - description: 'info about NVMe devices (model, serial number, namespace, firmware revision)'
      command: 'nvme list'
    - description: 'list partitions of a device (size, sector size, offset, file system code)'
      command: 'fdisk -l /dev/<device>'
    - description: 'get file system of a block device'
      command: 'file -s /dev/<block device>'

dump:
  glossary:
    - name: 'device'
      examples: 
        - '/dev/sdX'
        - '/dev/nvmeXn'
    - name: 'block device'
      examples:
        - '/dev/sdXY'
        - '/dev/nvmeXnYpZ'
  tools:
    - 'write blocker (in place before any disk dump)'
    - 'RamCapturer'
    - 'FTK Imager'
    - 'dc3dd/dd/ddrescue'
    - 'LiMe'
  cheat_sheet:
    - description: 'dump memory on windows (require local admin privilege)'
      command: 'RamCapturer, FTK Imager software'
    - description: 'dump memory on linux with dd'
      command: 'dd if=/dev/fmem of=./memory.raw bs=1MB count=<memory size in MB>'
    - description: 'dump memory on linux with LiMe'
      command: 'insmod <lime_compiled.ko> “path=./memory.raw format=raw” && rmmod <lime_compiled.ko>'
    - description: 'dump disk with dc3dd (with integrity hash and verification)'
      command: 'dc3dd if=/dev/<device> hof=./disk.raw bs=<bytes per sector> hash=sha256 log=dc3dd_disk.log'
    - description: 'dump disk with ddrescue (copy good sectors)'
      command: 'ddrescue -i0 -d -N /dev/<device> disk.raw ddrescue_map.txt'
    - description: 'dump disk with ddrescue (try copying bad sectors, based on map file)'
      command: 'ddrescue -r3 -d /dev/<device> disk.raw ddrescue_map.txt'
    - description: 'compute and verify integrity check'
      command: 'echo "<hash> <filename>" | sha256sum --check'

mount:
  glossary:
    - name: 'device'
      examples: 
        - '/dev/sdX'
        - '/dev/nvmeXn'
    - name: 'block device'
      examples:
        - '/dev/sdXY'
        - '/dev/nvmeXnYpZ'
    - name: 'file system driver'
      examples:
        - 'ext4'
        - 'ntfs-3g'
        - 'vfat'
    - name: 'mount options'
      examples:
        - 'loop (create loop device)'
        - 'noatime (do not update access time)'
        - 'noexec (prevent execution)'
        - 'show_sys_files (ntfs, get metafiles)'
        - 'streams_interface=windows (ntfs, get alternate data streams)'
  tools:
    - 'fdisk'
    - 'file'
    - 'losetup'
    - 'mount'
    - 'ewf-tools (with libewf2=20140608-6.1build1)'
    - 'qemu-img'
    - 'dislocker'
    - 'imagemounter'
  cheat_sheet:
    - description: 'list partitions of a device (size, sector size, offset, file system code)'
      command: 'fdisk -l /dev/<device>'
    - description: 'create a loop device for each partition in ro (eg. to then mount a vmdk)'
      command: 'losetup -Prf --show disk.img'
    - description: 'get file system of a partition with file'
      command: 'file -s /dev/<loopXp*>'
    - description: 'get file system of a partition with fsstat'
      command: 'fsstat /dev/<loopXp*>'
    - description: 'mount partition from loop in kernel space'
      command: 'mount -t <file system driver> -o ro,noatime,noexec,<ntfs options> /dev/<loopXpY> <mount point>'
    - description: 'mount partition including loop device creation in kernel space'
      command: 'mount -t <file system driver> -o loop,offset=$((offset x bytes per sector)),ro,noatime,noexec,<ntfs options> disk.raw <mount point>'
    - description: 'mount a encase image'
      command: 'ewfmount -X allow_root + losetup -Prf + mount (or imount then mount when issues)'
    - description: 'mount LVM disk dump'
      command: 'losetup -Pf + pvdisplay + vgchange -a y <volume name> + mount'
    - description: 'mount with imagemounter (pip package)'
      command: 'imount -v -k -m xmount /dev/loop0, if failing, the dd might be usable in /tmp/image_mounter_XXX'
    - description: 'mount partition in user space (mount under /media/ or /run/media/$USER)'
      command: 'udiskctl mount --block-device /dev/<block device> --options ro,noatime,noexec,<ntfs options>'
    - description: 'list mounted devices'
      command: 'cat /proc/mounts'
    - description: 'unmount a device (mounted with option loop) in kernel space'
      command: 'unmount <mount point>'
    - description: 'unmount a device in user space'
      command: 'udiskctl umount --block-device /dev/<block device>'
    - description: 'unmount a device then delete the loop device'
      command: 'unmount <mount point> && losetup -d /dev/<loopX>'
    - description: 'convert encase to raw dump'
      command: 'ewfexport -t disk.raw -f raw -u disk.e01'
    - description: 'convert vhdx to raw dump'
      command: 'qemu-img convert -p -m1 -f vhdx -O raw disk.vhdx disk.raw'